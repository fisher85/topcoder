F. Предсказание тематик по тексту
В Яндекс.Дзене много материалов, и чтобы пользователям было проще ориентироваться в огромном многообразии контента, мы используем тематические теги. При помощи алгоритма машинного обучения мы определяем, к каким темам относится определённый документ, и показываем его подходящим пользователям. В этом задании вам нужно построить такой алгоритм классификации документов.
На входе для каждого документа даны два текстовых поля: заголовок (title) и содержимое документа (content). Для каждого документа из обучающей выборки вам также известно, к каким темам он относится (одной или нескольким). Например, документ с заголовком «Десять правил для лучшей жизни» относится к темам «Саморазвитие» и «Успех и мотивация».
Вам предстоит сделать прогнозы для тестового набора данных. Для оценки качества прогноза используется F1-мера, усреднённая по документам тестовой выборки (аналогично sklearn.metrics.f1_score(y_true, y_pred, average=’samples’)). К примеру, пусть для документа идентификаторы предсказанных тематик — 1, 2, 3, а правильные — 2, 3, 4, 5. Тогда для этого документа точность = 2/3, полнота = 2/4, F1-мера = 0,57. Итоговое значение F1-меры для набора документов получается путём усреднения значений F1-меры по всем документам этого набора.
При отправке решения F1-мера вычисляется на публичной части тестовой выборки (50% выборки). Финальное значение F1-меры будет определено по скрытой части тестовой выборки (другие 50% выборки), чтобы исключить переобучение. Это значение будет опубликовано после окончания тура.
Для удобства отображения в таблице результатов значения F1-меры умножаются на 100.
Оценивается только последняя посылка. Убедитесь, что на момент окончания тура ваша последняя посылка содержит именно тот прогноз, для которого вы хотите чтобы было посчитано финальное значение метрики на скрытой части тестовой выборки.

Формат ввода
В файле с обучающей выборкой в каждой строке через табуляцию записаны числовой id документа, заголовок, содержимое, список числовых идентификаторов тем. Все идентификаторы тем в списке — целые числа от 0 до 99, разделённые запятыми.
Формат train.tsv:

0 Интересный заголовок Много букв в статье 1,2,3  
1 Классный заголовок Какой-то текст 3  
...
В файле с тестовой выборкой в каждой строке через табуляцию записаны id документа, заголовок, содержимое.
Формат test.tsv:

0 Очень интересный заголовок Много слов в статье  
1 Заголовок Текст  
...
Формат вывода
В файле с решением для каждого документа из тестовой выборки должна быть ровно одна строка с предсказанными темами. В каждой строке файла через табуляцию должны быть записаны id документа и непустой список предсказанных идентификаторов тем. Все идентификаторы тем в списке должны быть различными целыми числами от 0 до 99, разделёнными запятыми.
Формат submission.tsv:

0 0  
1 2,3  
...
Примечания
Датасеты можно скачать по ссылке: https://yadi.sk/d/0WeLsXCE6ksyAw

Участников, оказавшихся на первых позициях по итогам тура, мы попросим выслать исходный код решения, который позволяет воспроизвести результат, для экспертизы. Только в случае успешного прохождения экспертизы жюри участник может быть признан победителем финального этапа и получить призы.